# Règles de test XSS explicites pour validation du filtrage
# Ces règles utilisent "any any -> any any" pour matcher tout trafic
# SIMPLIFIÉES pour compatibilité Hyperscan (pas de lookaheads, pas de caractères problématiques)

# Règle simple pour test - matche "XSS" littéralement (facile à tester)
drop tcp any any -> any any (msg:"TEST Simple XSS marker"; flow:to_server,established; content:"XSS"; sid:999001; rev:1;)

# Règle XSS avec alert - sans parenthèse pour éviter problèmes Hyperscan
drop tcp any any -> any any (msg:"TEST XSS Alert Function"; flow:to_server,established; content:"alert"; nocase; sid:999002; rev:1;)

# Règle XSS avec javascript:
drop tcp any any -> any any (msg:"TEST XSS javascript protocol"; flow:to_server,established; content:"javascript"; nocase; sid:999003; rev:1;)

# Règle XSS avec onerror
drop tcp any any -> any any (msg:"TEST XSS Event Handler onerror"; flow:to_server,established; content:"onerror"; nocase; sid:999004; rev:1;)

# Règle XSS avec onload
drop tcp any any -> any any (msg:"TEST XSS Event Handler onload"; flow:to_server,established; content:"onload"; nocase; sid:999005; rev:1;)

# Règle XSS basique - détecte script dans le payload (sans < pour éviter échappements)
drop tcp any any -> any any (msg:"TEST XSS Basic - script tag"; flow:to_server,established; content:"script"; nocase; sid:999006; rev:1;)

# Règle SQL Injection test - UNION
drop tcp any any -> any any (msg:"TEST SQLi UNION"; flow:to_server,established; content:"UNION"; nocase; sid:999007; rev:1;)

# Règle SQL Injection test - SELECT  
drop tcp any any -> any any (msg:"TEST SQLi SELECT"; flow:to_server,established; content:"SELECT"; nocase; sid:999008; rev:1;)
